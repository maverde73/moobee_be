TABELLA: cv_extractions
DESCRIZIONE: Original company name as provided
  normalized_name           String?                     @unique @db.VarChar(200)  /// Lowercase, no spaces for deduplication
  industry_id               Int?  /// Optional link to industries table
  website                   String?  /// Company website URL
  created_at                DateTime?                   @default(now()) @db.Timestamp(6)
  updated_at                DateTime?                   @default(now()) @db.Timestamp(6)
  industries                industries?                 @relation(fields: [industry_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  employee_work_experiences employee_work_experiences[]  /// All work experiences at this company

  @@index([industry_id], map: "idx_companies_industry")
  @@index([normalized_name], map: "idx_companies_normalized_name")
}

This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.

CAMPI UTILIZZABILI (USA ESATTAMENTE QUESTI NOMI):
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

IDENTIFICATIVI:
- id (uuid): Campo id [PRIMARY KEY] [DEFAULT: uuid_generate_v4()]

ALTRI CAMPI:
- tenant_id (uuid): Campo tenant_id [REQUIRED]
- original_file_path (text): Campo original_file_path
- file_size_bytes (bigint): Campo file_size_bytes
- file_type (character varying(50)): Campo file_type
- extraction_result (jsonb): Campo extraction_result [JSONB]
- error_message (text): Campo error_message
- processing_time_seconds (double precision): Campo processing_time_seconds
- llm_model_used (character varying(100)): Campo llm_model_used
- deleted_by (text): Campo deleted_by
- extracted_text (text): Campo extracted_text
- llm_cost (numeric): Campo llm_cost
- import_stats (jsonb): Campo import_stats [JSONB]
- error_phase (text): Campo error_phase

RELAZIONI PRINCIPALI:
- employee_id (integer): Campo employee_id [REQUIRED] [FK verso employees]

DATI ANAGRAFICI:
- original_filename (character varying(500)): Campo original_filename

STATI E FLAGS:
- status (character varying(50)): Campo status [DEFAULT: pending]

DATI TECNICI:
- llm_tokens_used (integer): Campo llm_tokens_used

DATE E TIMESTAMP:
- deleted_at (timestamp without time zone): Campo deleted_at
- created_at (timestamp without time zone): Campo created_at [DEFAULT: now()]
- updated_at (timestamp without time zone): Campo updated_at [DEFAULT: now()]
- updated_by (text): Campo updated_by

RELAZIONI:
━━━━━━━━━━
- employees (N:1): Collegamento via employee_id
  * ON DELETE: CASCADE
  * ON UPDATE: NO ACTION
- employee_languages (1:N): employee_languages referenzia questa tabella via cv_extraction_id
- employee_certifications (1:N): employee_certifications referenzia questa tabella via cv_extraction_id
- employee_education (1:N): employee_education referenzia questa tabella via cv_extraction_id
- employee_work_experiences (1:N): employee_work_experiences referenzia questa tabella via cv_extraction_id
- employee_projects (1:N): employee_projects referenzia questa tabella via cv_extraction_id
- employee_publications (1:N): employee_publications referenzia questa tabella via cv_extraction_id
- employee_awards (1:N): employee_awards referenzia questa tabella via cv_extraction_id
- employee_additional_info (1:N): employee_additional_info referenzia questa tabella via cv_extraction_id
- employee_skills (1:N): employee_skills referenzia questa tabella via cv_extraction_id
- employee_domain_knowledge (1:N): employee_domain_knowledge referenzia questa tabella via cv_extraction_id
- cv_files (1:N): cv_files referenzia questa tabella via extraction_id

REGOLE BUSINESS:
━━━━━━━━━━━━━━━━
1. Campi obbligatori: tenant_id, employee_id
2. La cancellazione di employees cancella automaticamente questo record
3. Vincolo: ((status)::text = ANY ((ARRAY['pending'::character varying, 'processing'::character varying, 'extracted'::character varying, 'importing'::character varying, 'completed'::character varying, 'failed'::character varying])::text[]))
4. Il timestamp di creazione viene impostato automaticamente

QUERY COMUNI:
━━━━━━━━━━━━

1. Recupera tutti i record di cv_extractions per un tenant:
{
  "table": "cv_extractions",
  "select": [
    "id",
    "tenant_id",
    "employee_id",
    "original_filename",
    "original_file_path"
  ],
  "where": {
    "tenant_id": "uuid_tenant"
  },
  "limit": 100
}

2. Recupera cv_extractions con dati di employees:
{
  "table": "cv_extractions",
  "select": [
    "*"
  ],
  "leftJoin": [
    {
      "table": "employees",
      "first": "cv_extractions.employee_id",
      "second": "employees.id"
    }
  ],
  "limit": 50
}

3. Ricerca cv_extractions per original_filename:
{
  "table": "cv_extractions",
  "select": [
    "*"
  ],
  "where": {
    "original_filename": {
      "operator": "like",
      "value": "%search%"
    }
  },
  "limit": 20
}

4. Conta cv_extractions creati nell'ultimo mese:
{
  "table": "cv_extractions",
  "select": [
    "COUNT(*) as total"
  ],
  "where": {
    "created_at": {
      "operator": ">=",
      "value": "NOW() - INTERVAL '30 days'"
    }
  }
}

NOTE IMPORTANTI:
━━━━━━━━━━━━━━━
- Tabella multi-tenant: tutti i record sono isolati per tenant_id
- Performance: Tabella ottimizzata con 4 indici
- Campo extraction_result (JSONB): verificare schema JSON atteso nella documentazione

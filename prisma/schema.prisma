generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model assessment_generation_logs {
  id                                                                                    String                 @id
  templateId                                                                            Int?
  provider                                                                              String
  model                                                                                 String
  status                                                                                String
  questionsCount                                                                        Int?
  generationType                                                                        String
  metadata                                                                              Json?
  requestParams                                                                         Json?
  responseTime                                                                          Int?
  errorMessage                                                                          String?
  userId                                                                                String?
  createdAt                                                                             DateTime               @default(now())
  assessment_templates_assessment_generation_logs_templateIdToassessment_templates      assessment_templates?  @relation("assessment_generation_logs_templateIdToassessment_templates", fields: [templateId], references: [id])
  assessment_templates_assessment_templates_generationLogIdToassessment_generation_logs assessment_templates?  @relation("assessment_templates_generationLogIdToassessment_generation_logs")
  assessment_templates_TemplateGenerationLog                                            assessment_templates[] @relation("TemplateGenerationLog")
}

model assessment_instance_responses {
  id                   Int                  @id @default(autoincrement())
  instanceId           Int
  questionId           Int
  answer               Json
  score                Float?
  createdAt            DateTime             @default(now())
  assessment_instances assessment_instances @relation(fields: [instanceId], references: [id])

  @@unique([instanceId, questionId])
  @@index([instanceId])
}

model assessment_instances {
  id                            Int                             @id @default(autoincrement())
  scheduleId                    Int                             @unique
  userId                        String
  tenantId                      String                          @db.Uuid
  templateId                    Int
  startedAt                     DateTime
  completedAt                   DateTime?
  timeSpent                     Int?
  reportUrl                     String?
  assessment_instance_responses assessment_instance_responses[]
  assessment_schedules          assessment_schedules            @relation(fields: [scheduleId], references: [id])
  user_soft_skills              user_soft_skills[]

  @@index([completedAt])
  @@index([tenantId])
  @@index([userId])
}

model assessment_options {
  id                   Int                  @id @default(autoincrement())
  questionId           Int
  text                 String
  value                Int
  orderIndex           Int?                 @default(0)
  assessment_questions assessment_questions @relation(fields: [questionId], references: [id])
}

model assessment_questions {
  id                           Int                            @id @default(autoincrement())
  templateId                   Int
  text                         String
  type                         String
  category                     String?
  order                        Int?
  softSkillMapping             Json?
  isRequired                   Boolean?                       @default(true)
  assessment_options           assessment_options[]
  assessment_templates         assessment_templates           @relation(fields: [templateId], references: [id])
  question_soft_skill_mappings question_soft_skill_mappings[]
}

model assessment_schedules {
  id                           Int                          @id @default(autoincrement())
  tenantSelectionId            Int
  userId                       String
  assignedBy                   String
  scheduledDate                DateTime
  dueDate                      DateTime
  reminderDates                Json?
  status                       ScheduleStatus               @default(SCHEDULED)
  createdAt                    DateTime                     @default(now())
  updatedAt                    DateTime
  assessment_instances         assessment_instances?
  tenant_assessment_selections tenant_assessment_selections @relation(fields: [tenantSelectionId], references: [id])

  @@index([scheduledDate])
  @@index([status])
  @@index([userId])
}

model assessment_soft_skill_scores {
  id               Int      @id @default(autoincrement())
  assessmentId     Int
  softSkillId      Int
  algorithmVersion String   @default("v1.0")
  employeeId       Int
  calculatedAt     DateTime @default(now())
  confidence       Float?
  level            String   @default("beginner")
  normalizedScore  Float
  percentile       Int?
  rawScore         Float
  scoreDetails     Json?

  @@unique([assessmentId, employeeId, softSkillId])
  @@index([assessmentId])
  @@index([employeeId])
  @@index([softSkillId])
}

model assessment_templates {
  id                                                                                          Int                              @id @default(autoincrement())
  name                                                                                        String
  type                                                                                        String?
  description                                                                                 String?
  isActive                                                                                    Boolean                          @default(true)
  createdBy                                                                                   String?
  version                                                                                     String?
  createdAt                                                                                   DateTime                         @default(now())
  updatedAt                                                                                   DateTime
  scoringAlgorithm                                                                            String                           @default("weighted")
  softSkillsEnabled                                                                           Boolean                          @default(false)
  aiProvider                                                                                  String?
  generationLogId                                                                             String?                          @unique
  generationStatus                                                                            String?
  createdByAdmin                                                                              String?
  isGlobal                                                                                    Boolean                          @default(false)
  aiPrompt                                                                                    String?
  instructions                                                                                String?
  suggestedFrequency                                                                          String?                          @db.VarChar(255)
  aiModel                                                                                     String?                          @default("gpt-4-turbo") @db.VarChar(255)
  aiTemperature                                                                               Decimal?                         @default(0.7) @db.Decimal(3, 2)
  aiMaxTokens                                                                                 Int?                             @default(4000)
  aiLanguage                                                                                  String?                          @default("it") @db.VarChar(10)
  job_family_id                                                                               Int?
  campaigns                                                                                   assessment_campaigns[]
  assessment_generation_logs_assessment_generation_logs_templateIdToassessment_templates      assessment_generation_logs[]     @relation("assessment_generation_logs_templateIdToassessment_templates")
  assessment_questions                                                                        assessment_questions[]
  assessment_template_soft_skill                                                              assessment_template_soft_skill[]
  assessment_generation_logs_assessment_templates_generationLogIdToassessment_generation_logs assessment_generation_logs?      @relation("assessment_templates_generationLogIdToassessment_generation_logs", fields: [generationLogId], references: [id])
  job_family                                                                                  job_family?                      @relation(fields: [job_family_id], references: [id], onUpdate: NoAction, map: "fk_assessment_job_family")
  tenant_assessment_selections                                                                tenant_assessment_selections[]
  assessment_generation_logs_TemplateGenerationLog                                            assessment_generation_logs[]     @relation("TemplateGenerationLog")

  @@index([job_family_id], map: "idx_assessment_templates_job_family")
}

model assessments {
  id                Int       @id @default(autoincrement())
  employee_id       Int
  assessment_type   String    @db.VarChar(50)
  assessment_date   DateTime  @default(dbgenerated("CURRENT_DATE")) @db.Date
  overall_score     Decimal?  @db.Decimal(5, 2)
  technical_score   Decimal?  @db.Decimal(5, 2)
  soft_skills_score Decimal?  @db.Decimal(5, 2)
  notes             String?
  assessed_by       Int?
  status            String?   @default("DRAFT") @db.VarChar(50)
  created_at        DateTime? @default(now()) @db.Timestamp(6)
  updated_at        DateTime? @default(now()) @db.Timestamp(6)
  tenant_id         String    @db.Uuid
}

model career_aspirations {
  id              Int       @id @default(autoincrement())
  employee_id     Int
  target_role_id  Int?
  target_position String?   @db.VarChar(200)
  target_date     DateTime? @db.Date
  notes           String?
  is_active       Boolean?  @default(true)
  created_at      DateTime? @default(now()) @db.Timestamp(6)
  updated_at      DateTime? @default(now()) @db.Timestamp(6)
  tenant_id       String    @db.Uuid
}

model departments {
  id                   Int         @id @default(autoincrement())
  department_name      String      @db.VarChar(100)
  department_code      String?     @db.VarChar(20)
  manager_id           Int?
  parent_department_id Int?
  is_active            Boolean?    @default(true)
  created_at           DateTime?   @default(now()) @db.Timestamp(6)
  updated_at           DateTime?   @default(now()) @db.Timestamp(6)
  tenant_id            String      @db.Uuid
  employees            employees[]
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model employee_roles {
  id              Int       @id @default(autoincrement())
  employee_id     Int
  role_id         Int
  sub_role_id     Int?
  created_at      DateTime? @default(now()) @db.Timestamp(6)
  tenant_id       String
  anni_esperienza Int?      @default(0)
  seniority       String?   @db.VarChar(50)
  is_current      Boolean?  @default(false)
  employees       employees @relation(fields: [employee_id], references: [id])
  tenants         tenants   @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_employee_roles_tenant")

  @@index([seniority], map: "idx_employee_roles_seniority")
  @@index([employee_id, sub_role_id], map: "idx_employee_roles_employee_subrole")
  @@index([sub_role_id], map: "idx_employee_roles_sub_role_id")
}

model employee_skills {
  id                Int             @id @default(autoincrement())
  employee_id       Int
  skill_id          Int
  proficiency_level Float?
  years_experience  Decimal?        @db.Decimal(3, 1)
  last_used_date    DateTime?       @db.Date
  notes             String?
  created_at        DateTime?       @default(now()) @db.Timestamp(6)
  updated_at        DateTime?       @default(now()) @db.Timestamp(6)
  tenant_id         String
  source            String?         @default("manual") @db.VarChar(50)
  cv_extraction_id  String?         @db.Uuid
  cv_extractions    cv_extractions? @relation(fields: [cv_extraction_id], references: [id], onUpdate: NoAction, map: "fk_employee_skills_cv_extraction")
  tenants           tenants         @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_employee_skills_tenant")

  @@unique([employee_id, skill_id], map: "idx_employee_skills_unique")
  @@index([cv_extraction_id], map: "idx_employee_skills_cv_extraction")
  @@index([tenant_id, employee_id], map: "idx_employee_skills_tenant_employee")
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model employees {
  id                              Int                               @id @default(autoincrement())
  employee_code                   String?                           @db.VarChar(50)
  first_name                      String                            @db.VarChar(100)
  last_name                       String                            @db.VarChar(100)
  email                           String                            @db.VarChar(255)
  phone                           String?                           @db.VarChar(20)
  hire_date                       DateTime?                         @db.Date
  department_id                   Int?
  position                        String?                           @db.VarChar(100)
  manager_id                      Int?
  is_active                       Boolean?                          @default(true)
  created_at                      DateTime?                         @default(now()) @db.Timestamp(6)
  updated_at                      DateTime?                         @default(now()) @db.Timestamp(6)
  tenant_id                       String                            @db.Uuid
  currentRoleId                   Int?
  lastAssessmentDate              DateTime?
  nextAssessmentDue               DateTime?
  softSkillProfileId              Int?
  competenze_trasversali          Json?                             @default("[]")
  assessment_campaign_assignments assessment_campaign_assignments[]
  assessment_results              assessment_results[]
  cv_extractions                  cv_extractions[]
  employee_additional_info        employee_additional_info?
  employee_awards                 employee_awards[]
  employee_certifications         employee_certifications[]
  employee_domain_knowledge       employee_domain_knowledge[]
  employee_education              employee_education[]
  employee_languages              employee_languages[]
  employee_projects               employee_projects[]
  employee_publications           employee_publications[]
  employee_roles                  employee_roles[]
  employee_work_experiences       employee_work_experiences[]
  departments                     departments?                      @relation(fields: [department_id], references: [id])
  engagement_campaign_assignments engagement_campaign_assignments[]
  engagement_results              engagement_results[]
  project_matching_results        project_matching_results[]
  projects                        projects[]
  tenant_users                    tenant_users[]
}

model engagement_surveys {
  id                 Int       @id @default(autoincrement())
  employee_id        Int
  survey_month       DateTime  @db.Date
  job_satisfaction   Int?
  work_life_balance  Int?
  career_development Int?
  team_collaboration Int?
  manager_support    Int?
  overall_score      Decimal?  @db.Decimal(3, 1)
  achieved_goals     String[]
  challenges_faced   String[]
  support_needed     String[]
  comments           String?
  created_at         DateTime? @default(now()) @db.Timestamp(6)
  tenant_id          String    @db.Uuid
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model extended_descriptions_roles {
  id                        Int?
  Extended_Description_Role String?
  Role                      String?

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model extended_descriptions_skills {
  id                   Int     @id
  Extended_Description String?
  Skill                String?

  @@ignore
}

model extended_descriptions_sub_roles {
  id                            Int     @id @default(autoincrement())
  Extended_Description_Sub_Role String?
  Sub_Role                      String?
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model extended_tech_skills_roles_descriptions_full {
  id                        Int      @id(map: "ext_full_pkey") @default(autoincrement())
  Skill                     String?
  Role                      String?
  Description_Code          Int?
  Description               String?
  Hot_Technology            String?
  In_Demand                 String?
  NameKnown_Skill           String?
  Synonyms_Skill            String[]
  NameKnown_Role            String?
  Synonyms_Role             String[]
  Extended_Description      String?
  Extended_Description_Role String?
  id_skill                  Int?
  id_role                   Int?
  Grading                   Float?
  Value                     Float?

  @@unique([id_skill, id_role], map: "ext_full_skill_role_uq")
  @@ignore
}

model notifications {
  id          Int       @id @default(autoincrement())
  employee_id Int
  type        String    @db.VarChar(50)
  title       String    @db.VarChar(200)
  message     String?
  is_read     Boolean?  @default(false)
  read_at     DateTime? @db.Timestamp(6)
  created_at  DateTime? @default(now()) @db.Timestamp(6)
}

model project_assignments {
  id                    Int       @id @default(autoincrement())
  project_id            Int
  employee_id           Int
  role_in_project       String?   @db.VarChar(100)
  allocation_percentage Int?
  start_date            DateTime  @db.Date
  end_date              DateTime? @db.Date
  is_active             Boolean?  @default(true)
  created_at            DateTime? @default(now()) @db.Timestamp(6)
  tenant_id             String    @db.Uuid

  @@index([start_date, end_date], map: "idx_assignments_dates")
  @@index([employee_id], map: "idx_assignments_employee")
  @@index([start_date, end_date], map: "idx_project_assignments_dates")
  @@index([employee_id], map: "idx_project_assignments_employee")
}

model project_skills_required {
  id             Int      @id @default(autoincrement())
  project_id     Int
  skill_id       Int
  required_level Int?
  is_mandatory   Boolean? @default(false)
}

model projects {
  id                    Int                     @id @default(autoincrement())
  project_name          String                  @db.VarChar(200)
  project_code          String?                 @db.VarChar(50)
  description           String?
  client_name           String?                 @db.VarChar(200)
  start_date            DateTime?               @db.Date
  end_date              DateTime?               @db.Date
  budget                Decimal?                @db.Decimal(12, 2)
  status                String?                 @default("PLANNING") @db.VarChar(50)
  pm_id                 Int?
  created_at            DateTime?               @default(now()) @db.Timestamp(6)
  updated_at            DateTime?               @default(now()) @db.Timestamp(6)
  tenant_id             String                  @db.Uuid
  objectives            Json?
  deliverables          Json?
  constraints           Json?
  risks                 Json?
  notes                 String?
  team_size             Int?
  completion_percentage Decimal?                @default(0) @db.Decimal(5, 2)
  tags                  String[]                @db.VarChar(255)
  is_archived           Boolean?                @default(false)
  archived_at           DateTime?               @db.Timestamp(6)
  priority              String?                 @default("MEDIUM") @db.VarChar(20)
  type                  String?                 @default("FORMAL") @db.VarChar(20)
  context_preferences   Json?
  created_by            String?                 @db.VarChar(255)
  is_active             Boolean?                @default(true)
  project_activity_logs project_activity_logs[]
  project_milestones    project_milestones[]
  project_roles         project_roles[]
  employees             employees?              @relation(fields: [pm_id], references: [id], onUpdate: NoAction)

  @@index([start_date, end_date], map: "idx_projects_dates")
  @@index([deliverables], map: "idx_projects_deliverables", type: Gin)
  @@index([is_archived], map: "idx_projects_is_archived")
  @@index([objectives], map: "idx_projects_objectives", type: Gin)
  @@index([pm_id], map: "idx_projects_pm_id")
  @@index([priority], map: "idx_projects_priority")
  @@index([status], map: "idx_projects_status")
  @@index([tags], map: "idx_projects_tags", type: Gin)
  @@index([tenant_id], map: "idx_projects_tenant")
  @@index([type], map: "idx_projects_type")
}

model question_soft_skill_mappings {
  id                   Int                  @id @default(autoincrement())
  questionId           Int
  softSkillId          Int
  createdAt            DateTime             @default(now())
  updatedAt            DateTime
  mappingType          String               @default("primary")
  modelDimension       String?
  modelType            String?
  weight               Float                @default(1.0)
  assessment_questions assessment_questions @relation(fields: [questionId], references: [id])
  soft_skills          soft_skills          @relation(fields: [softSkillId], references: [id])

  @@unique([questionId, softSkillId])
  @@index([questionId])
  @@index([softSkillId])
}

model role_mappings {
  role_id   Int    @id
  role_name String
}

model role_soft_skills {
  id          Int         @id @default(autoincrement())
  roleId      Int
  softSkillId Int
  priority    Int
  minScore    Float?
  createdAt   DateTime    @default(now())
  isRequired  Boolean     @default(false)
  weight      Float       @default(1.0)
  description String?
  targetScore Float?
  updatedAt   DateTime
  roles       roles       @relation(fields: [roleId], references: [id])
  soft_skills soft_skills @relation(fields: [softSkillId], references: [id])

  @@unique([roleId, softSkillId])
  @@index([roleId])
  @@index([softSkillId])
}

model role_sub_role {
  id          Int        @id @default(autoincrement())
  id_role     Int
  id_sub_role Int?
  created_at  DateTime?  @default(now()) @db.Timestamp(6)
  roles       roles      @relation(fields: [id_role], references: [id], onDelete: Cascade, map: "fk_role_sub_role_role")
  sub_roles   sub_roles? @relation(fields: [id_sub_role], references: [id], onDelete: Cascade, map: "fk_role_sub_role_sub")

  @@unique([id_role, id_sub_role], map: "uq_role_sub_role")
  @@index([id_role], map: "idx_role_sub_role_role")
  @@index([id_sub_role], map: "idx_role_sub_role_sub")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model role_sub_role_backup {
  id          Int?
  Role        String?
  Sub_Role    String?
  id_role     Int?
  id_sub_role Int?

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model role_sub_role_backup_final {
  id_role     Int?
  id_sub_role Int?

  @@ignore
}

model roles {
  id               Int                @id @default(autoincrement())
  Role             String?
  NameKnown_Role   String?
  Synonyms_Role    String[]
  createdAt        DateTime           @default(now())
  department       String?
  description      String?
  isActive         Boolean            @default(true)
  level            String?
  name             String?
  updatedAt        DateTime?
  action_plans     action_plans[]
  role_soft_skills role_soft_skills[]
  role_sub_role    role_sub_role[]
}

model skill_gaps {
  id             Int       @id @default(autoincrement())
  employee_id    Int
  role_id        Int
  skill_id       Int
  current_level  Int?
  required_level Int?
  gap_size       Int?
  gap_percentage Decimal?  @db.Decimal(5, 2)
  priority       String?   @db.VarChar(20)
  calculated_at  DateTime? @default(now()) @db.Timestamp(6)
}

model skills {
  id                     Int                      @id @default(autoincrement())
  Skill                  String?
  NameKnown_Skill        String?
  Synonyms_Skill         String[]
  tenant_id              String?                  @db.VarChar(255)
  created_by             String?                  @db.VarChar(255)
  is_active              Boolean?                 @default(true)
  created_at             DateTime?                @default(now()) @db.Timestamp(6)
  updated_at             DateTime?                @default(now()) @db.Timestamp(6)
  tenants                tenants?                 @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  skills_sub_roles_value skills_sub_roles_value[]

  @@unique([Skill, tenant_id], map: "unique_skill_per_tenant")
  @@index([is_active], map: "idx_skills_active")
  @@index([tenant_id, is_active, Skill], map: "idx_skills_composite")
  @@index([Skill], map: "idx_skills_skill")
  @@index([tenant_id], map: "idx_skills_tenant_id")
}

model soft_skills {
  id                             Int                              @id @default(autoincrement())
  name                           String
  nameEn                         String?
  description                    String?
  category                       String?
  isActive                       Boolean                          @default(true)
  createdAt                      DateTime                         @default(now())
  updatedAt                      DateTime
  code                           String                           @unique
  descriptionEn                  String?
  evaluationCriteria             Json?
  orderIndex                     Int                              @default(0)
  assessment_template_soft_skill assessment_template_soft_skill[]
  job_family_soft_skills         job_family_soft_skills[]
  question_soft_skill_mappings   question_soft_skill_mappings[]
  role_soft_skills               role_soft_skills[]
  user_soft_skills               user_soft_skills[]
}

model soft_skills_assessments {
  id                           Int       @id @default(autoincrement())
  assessment_id                Int?
  employee_id                  Int
  communication_score          Int?
  teamwork_score               Int?
  problem_solving_score        Int?
  emotional_intelligence_score Int?
  leadership_score             Int?
  total_score                  Int?
  percentage_score             Decimal?  @db.Decimal(5, 2)
  skill_level                  String?   @db.VarChar(50)
  completed_at                 DateTime? @db.Timestamp(6)
  created_at                   DateTime? @default(now()) @db.Timestamp(6)
  tenant_id                    String    @db.Uuid
}

model sub_roles {
  id                     Int                      @id @default(autoincrement())
  Sub_Role               String?
  NameKnown_Sub_Role     String?
  Synonyms_Sub_Role      String[]
  tenant_id              String?                  @db.VarChar(255)
  is_custom              Boolean?                 @default(false)
  created_by             String?                  @db.VarChar(255)
  created_at             DateTime?                @default(now()) @db.Timestamp(6)
  project_roles          project_roles[]
  role_sub_role          role_sub_role[]
  skills_sub_roles_value skills_sub_roles_value[]

  @@index([tenant_id], map: "idx_sub_roles_tenant_id")
}

model job_family {
  id                     Int                      @id @default(autoincrement())
  name                   String                   @unique @db.VarChar(100)
  description            String?
  is_active              Boolean?                 @default(true)
  created_at             DateTime?                @default(now()) @db.Timestamp(6)
  updated_at             DateTime?                @default(now()) @updatedAt @db.Timestamp(6)
  assessment_templates   assessment_templates[]
  job_family_soft_skills job_family_soft_skills[]

  @@index([name], map: "idx_job_family_name")
  @@index([is_active], map: "idx_job_family_is_active")
}

model job_family_soft_skills {
  id            Int         @id @default(autoincrement())
  job_family_id Int
  soft_skill_id Int
  priority      Int
  min_score     Int
  is_required   Boolean     @default(false)
  weight        Decimal     @db.Decimal(3, 2)
  target_score  Int
  description   String?
  created_at    DateTime?   @default(now()) @db.Timestamp(6)
  updated_at    DateTime?   @default(now()) @updatedAt @db.Timestamp(6)
  job_family    job_family  @relation(fields: [job_family_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_jfss_job_family")
  soft_skills   soft_skills @relation(fields: [soft_skill_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_jfss_soft_skill")

  @@unique([job_family_id, soft_skill_id], map: "unique_job_family_soft_skill")
  @@index([job_family_id], map: "idx_jfss_job_family")
  @@index([soft_skill_id], map: "idx_jfss_soft_skill")
  @@index([is_required], map: "idx_jfss_required")
  @@index([priority], map: "idx_jfss_priority")
  @@index([job_family_id, priority], map: "idx_jfss_job_family_priority")
}

model assessment_template_soft_skill {
  id                   Int                  @id @default(autoincrement())
  templateId           Int
  softSkillId          Int
  questionMappings     Json
  createdAt            DateTime             @default(now())
  updatedAt            DateTime
  soft_skills          soft_skills          @relation(fields: [softSkillId], references: [id], map: "template_soft_skill_mappings_softSkillId_fkey")
  assessment_templates assessment_templates @relation(fields: [templateId], references: [id], map: "template_soft_skill_mappings_templateId_fkey")

  @@unique([templateId, softSkillId], map: "template_soft_skill_mappings_templateId_softSkillId_key")
  @@index([softSkillId], map: "template_soft_skill_mappings_softSkillId_idx")
  @@index([templateId], map: "template_soft_skill_mappings_templateId_idx")
}

model tenant_api_keys {
  id         Int       @id @default(autoincrement())
  tenant_id  String
  keyName    String
  apiKey     String    @unique
  isActive   Boolean   @default(true)
  expiresAt  DateTime?
  lastUsedAt DateTime?
  createdAt  DateTime  @default(now())
  tenants    tenants   @relation(fields: [tenant_id], references: [id])
}

model tenant_assessment_selections {
  id                   Int                    @id @default(autoincrement())
  templateId           Int
  isActive             Boolean                @default(true)
  selectedAt           DateTime               @default(now())
  selectedBy           String?
  assignmentRules      Json?
  customName           String?
  frequency            String?
  updatedAt            DateTime
  tenant_id            String                 @db.Uuid
  assessment_schedules assessment_schedules[]
  assessment_templates assessment_templates   @relation(fields: [templateId], references: [id])

  @@unique([tenant_id, templateId])
  @@index([templateId])
  @@index([tenant_id])
}

model tenant_audit_log {
  id        Int      @id @default(autoincrement())
  tenant_id String
  userId    Int?
  action    String
  entity    String?
  entityId  String?
  oldValue  Json?
  newValue  Json?
  ipAddress String?
  userAgent String?
  createdAt DateTime @default(now())
  tenants   tenants  @relation(fields: [tenant_id], references: [id])
}

model tenant_billing {
  id            Int      @id @default(autoincrement())
  tenant_id     String
  plan          String
  amount        Float
  currency      String   @default("EUR")
  status        String
  billingPeriod String
  startDate     DateTime
  endDate       DateTime
  invoiceUrl    String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime
  tenants       tenants  @relation(fields: [tenant_id], references: [id])
}

model tenant_features {
  id          Int      @id @default(autoincrement())
  tenant_id   String
  featureName String
  isEnabled   Boolean  @default(true)
  config      Json?
  createdAt   DateTime @default(now())
  updatedAt   DateTime
  tenants     tenants  @relation(fields: [tenant_id], references: [id])

  @@unique([tenant_id, featureName])
}

model tenant_soft_skill_profiles {
  id               Int      @id @default(autoincrement())
  profileName      String
  description      String?
  softSkillIds     Int[]
  isActive         Boolean  @default(true)
  createdAt        DateTime @default(now())
  updatedAt        DateTime
  createdBy        String?
  softSkillWeights Json?
  isDefault        Boolean  @default(false)
  roleIds          Int[]
  tenant_id        String   @db.Uuid

  @@index([tenant_id])
}

model tenant_users {
  id                        String               @id
  tenant_id                 String
  email                     String
  password                  String?
  password_hash             String?
  role                      String               @default("user")
  is_active                 Boolean              @default(true)
  last_login_at             DateTime?
  last_login_ip             String?
  login_count               Int                  @default(0)
  failed_login_count        Int                  @default(0)
  locked_until              DateTime?
  password_reset_token      String?
  password_reset_expires_at DateTime?
  force_password_change     Boolean              @default(false)
  refresh_token             String?
  refresh_token_expires_at  DateTime?
  employee_id               Int?
  created_at                DateTime             @default(now())
  updated_at                DateTime
  engagement_results        engagement_results[]
  employees                 employees?           @relation(fields: [employee_id], references: [id])
  tenants                   tenants              @relation(fields: [tenant_id], references: [id])

  @@unique([tenant_id, email])
}

model tenants {
  id                        String                      @id
  slug                      String?                     @unique
  name                      String
  companyName               String?
  domain                    String?
  email                     String                      @unique
  phone                     String?
  vat_number                String?
  tax_code                  String?
  address_street            String?
  address_city              String?
  address_state             String?
  address_zip               String?
  address_country           String?
  subscription_plan         String?                     @default("basic")
  subscription_status       String?                     @default("active")
  max_employees             Int                         @default(50)
  is_active                 Boolean                     @default(true)
  created_by                String?
  updated_by                String?
  address                   String?
  city                      String?
  country                   String?
  isActive                  Boolean                     @default(true)
  is_deleted                Boolean                     @default(false)
  plan                      String?                     @default("free")
  maxUsers                  Int                         @default(10)
  createdAt                 DateTime                    @default(now())
  updatedAt                 DateTime
  logo                      String?
  employee_additional_info  employee_additional_info[]
  employee_awards           employee_awards[]
  employee_certifications   employee_certifications[]
  employee_domain_knowledge employee_domain_knowledge[]
  employee_education        employee_education[]
  employee_languages        employee_languages[]
  employee_projects         employee_projects[]
  employee_publications     employee_publications[]
  employee_roles            employee_roles[]
  employee_skills           employee_skills[]
  employee_work_experiences employee_work_experiences[]
  skills                    skills[]
  tenant_api_keys           tenant_api_keys[]
  tenant_audit_log          tenant_audit_log[]
  tenant_billing            tenant_billing[]
  tenant_certifications     TenantCertification[]
  tenant_features           tenant_features[]
  tenant_users              tenant_users[]
}

model training_plans {
  id            Int       @id @default(autoincrement())
  employee_id   Int
  skill_id      Int?
  training_type String?   @db.VarChar(100)
  provider      String?   @db.VarChar(200)
  start_date    DateTime? @db.Date
  end_date      DateTime? @db.Date
  status        String?   @default("PLANNED") @db.VarChar(50)
  cost          Decimal?  @db.Decimal(10, 2)
  notes         String?
  created_at    DateTime? @default(now()) @db.Timestamp(6)
  updated_at    DateTime? @default(now()) @db.Timestamp(6)
  tenant_id     String    @db.Uuid
}

model user_soft_skills {
  id                   Int                  @id @default(autoincrement())
  userId               String
  instanceId           Int
  softSkillId          Int
  score                Float
  confidence           Float
  weight               Float
  previousScore        Float?
  trend                Trend?
  calculatedAt         DateTime             @default(now())
  assessment_instances assessment_instances @relation(fields: [instanceId], references: [id])
  soft_skills          soft_skills          @relation(fields: [softSkillId], references: [id])

  @@unique([userId, softSkillId, instanceId])
  @@index([softSkillId])
  @@index([userId])
}

model engagement_templates {
  id                  String                         @id @default(uuid())
  title               String
  description         String?
  type                String                         @default("CUSTOM")
  category            String                         @default("ENGAGEMENT")
  status              String                         @default("DRAFT")
  instructions        String?
  suggested_frequency String?
  estimated_time      Int?
  language            String                         @default("it")
  tags                String[]
  metadata            Json?
  tenant_id           String?
  created_by          String?
  created_at          DateTime                       @default(now())
  updated_at          DateTime                       @updatedAt
  suggested_roles     Json?
  ai_prompt           String?
  ai_provider         String?
  ai_model            String?
  campaigns           engagement_campaigns[]
  weights             engagement_question_weights[]
  questions           engagement_questions[]
  results             engagement_results[]
  selections          tenant_engagement_selections[]

  @@index([tenant_id])
  @@index([status])
  @@index([type])
}

model engagement_questions {
  id               String                        @id @default(uuid())
  template_id      String
  question_text    String
  question_type    String                        @default("LIKERT")
  order            Int
  required         Boolean                       @default(true)
  metadata         Json?
  options          engagement_options[]
  weights          engagement_question_weights[]
  template         engagement_templates          @relation(fields: [template_id], references: [id], onDelete: Cascade)
  responses        engagement_responses[]
  response_details response_details[]

  @@index([template_id])
  @@index([order])
}

model engagement_options {
  id          String                 @id @default(uuid())
  question_id String
  option_text String
  value       Int
  order       Int
  question    engagement_questions   @relation(fields: [question_id], references: [id], onDelete: Cascade)
  responses   engagement_responses[]

  @@index([question_id])
  @@index([order])
}

model engagement_campaigns {
  id                  String                            @id @default(uuid())
  tenant_id           String
  template_id         String
  name                String
  description         String?
  start_date          DateTime
  end_date            DateTime
  status              String                            @default("PLANNED")
  target_audience     Json?
  anonymous_responses Boolean                           @default(false)
  reminder_settings   Json?
  created_by          String
  created_at          DateTime                          @default(now())
  updated_at          DateTime                          @updatedAt
  frequency           String?
  has_responses       Boolean                           @default(false)
  assignments         engagement_campaign_assignments[]
  template            engagement_templates              @relation(fields: [template_id], references: [id])
  responses           engagement_responses[]
  results             engagement_results[]

  @@index([tenant_id])
  @@index([template_id])
  @@index([status])
  @@index([start_date])
  @@index([end_date])
}

model engagement_responses {
  id               String               @id @default(uuid())
  campaign_id      String
  user_id          String
  question_id      String
  option_id        String?
  response_text    String?
  response_value   Int?
  responded_at     DateTime             @default(now())
  campaign         engagement_campaigns @relation(fields: [campaign_id], references: [id])
  option           engagement_options?  @relation(fields: [option_id], references: [id])
  question         engagement_questions @relation(fields: [question_id], references: [id])
  response_details response_details[]

  @@unique([campaign_id, user_id, question_id])
  @@index([campaign_id])
  @@index([user_id])
  @@index([responded_at])
}

model engagement_results {
  id               String                          @id @default(uuid())
  campaign_id      String
  assignment_id    String
  employee_id      Int
  tenant_user_id   String
  template_id      String
  responses        Json
  weighted_scores  Json?
  area_scores      Json?
  overall_score    Float?
  engagement_index Float?
  percentile       Float?
  benchmark_score  Float?
  strengths        Json?
  improvements     Json?
  recommendations  Json?
  sentiment        String?
  trend            String?
  completed_at     DateTime
  started_at       DateTime?
  time_taken       Int?
  attempt_number   Int                             @default(1)
  completion_rate  Float?
  ip_address       String?
  user_agent       String?
  device_type      String?
  assignment       engagement_campaign_assignments @relation(fields: [assignment_id], references: [id])
  campaign         engagement_campaigns            @relation(fields: [campaign_id], references: [id])
  template         engagement_templates            @relation(fields: [template_id], references: [id])
  tenant_user      tenant_users                    @relation(fields: [tenant_user_id], references: [id])
  employee         employees                       @relation(fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_engagement_results_employee")

  @@unique([assignment_id, attempt_number])
  @@index([campaign_id])
  @@index([employee_id])
  @@index([tenant_user_id])
  @@index([completed_at])
  @@index([overall_score])
}

model engagement_question_weights {
  id            String               @id @default(uuid())
  template_id   String
  question_id   String
  area          String
  weight        Float                @default(1.0)
  impact_factor Float                @default(1.0)
  is_reversed   Boolean              @default(false)
  created_at    DateTime             @default(now())
  updated_at    DateTime             @updatedAt
  question      engagement_questions @relation(fields: [question_id], references: [id])
  template      engagement_templates @relation(fields: [template_id], references: [id])

  @@unique([template_id, question_id])
  @@index([template_id])
  @@index([area])
}

model tenant_engagement_selections {
  id              String               @id @default(uuid())
  tenant_id       String
  template_id     String
  is_active       Boolean              @default(true)
  selected_at     DateTime             @default(now())
  selected_by     String?
  custom_settings Json?
  template        engagement_templates @relation(fields: [template_id], references: [id])

  @@unique([tenant_id, template_id])
  @@index([tenant_id])
  @@index([template_id])
}

model engagement_campaign_assignments {
  id               String               @id @default(uuid())
  campaign_id      String
  assigned_at      DateTime             @default(now())
  assigned_by      String
  status           String               @default("ASSIGNED")
  started_at       DateTime?
  completed_at     DateTime?
  completion_rate  Float?
  last_accessed_at DateTime?
  reminder_count   Int                  @default(0)
  last_reminder_at DateTime?
  notes            String?
  employee_id      Int?
  campaign         engagement_campaigns @relation(fields: [campaign_id], references: [id])
  employee         employees?           @relation(fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_engagement_assignments_employee")
  results          engagement_results[]

  @@index([campaign_id])
  @@index([status])
  @@index([assigned_at])
  @@index([completed_at])
  @@index([employee_id], map: "idx_engagement_assignments_employee_id")
}

model response_details {
  id          String               @id @default(uuid())
  response_id String
  question_id String
  value       Int?
  text_value  String?
  created_at  DateTime             @default(now()) @db.Timestamp(6)
  question    engagement_questions @relation(fields: [question_id], references: [id])
  response    engagement_responses @relation(fields: [response_id], references: [id], onDelete: Cascade)

  @@unique([response_id, question_id])
  @@index([response_id])
  @@index([question_id])
}

model action_plans {
  id             String    @id @default(uuid())
  tenant_id      String    @db.Uuid
  role_id        Int?
  area           String
  name           String
  description    String
  actions        Json
  target_metrics Json
  status         String    @default("DRAFT")
  start_date     DateTime?
  end_date       DateTime?
  created_by     String
  created_at     DateTime  @default(now()) @db.Timestamp(6)
  updated_at     DateTime  @updatedAt @db.Timestamp(6)
  role           roles?    @relation(fields: [role_id], references: [id])

  @@index([tenant_id])
  @@index([role_id])
  @@index([area])
  @@index([status])
}

model assessment_campaigns {
  id                    String                            @id @default(uuid())
  tenant_id             String
  template_id           Int
  name                  String
  description           String?
  start_date            DateTime
  deadline              DateTime
  status                String                            @default("PLANNED")
  frequency             String                            @default("once")
  recurring_config      Json?
  mandatory             Boolean                           @default(false)
  allow_retakes         Boolean                           @default(false)
  max_attempts          Int?                              @default(1)
  target_audience       Json
  completion_stats      Json?
  notification_settings Json
  created_by            String
  created_at            DateTime                          @default(now())
  updated_at            DateTime                          @updatedAt
  archived_at           DateTime?
  assignments           assessment_campaign_assignments[]
  template              assessment_templates              @relation(fields: [template_id], references: [id])
  results               assessment_results[]

  @@index([tenant_id])
  @@index([status])
  @@index([start_date, deadline])
}

model assessment_campaign_assignments {
  id               String               @id @default(uuid())
  campaign_id      String
  status           String               @default("ASSIGNED")
  assigned_at      DateTime             @default(now())
  assigned_by      String
  started_at       DateTime?
  completed_at     DateTime?
  expired_at       DateTime?
  current_attempt  Int                  @default(0)
  total_attempts   Int                  @default(0)
  progress_percent Float?               @default(0)
  time_spent       Int?
  score            Float?
  result_id        String?
  employee_id      Int
  campaign         assessment_campaigns @relation(fields: [campaign_id], references: [id], onDelete: Cascade)
  employee         employees            @relation(fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_assessment_assignments_employee")

  @@index([status])
  @@index([employee_id], map: "idx_assessment_assignments_employee_id")
}

model assessment_results {
  id              String               @id @default(uuid())
  campaign_id     String
  assignment_id   String
  responses       Json
  scores          Json
  overall_score   Float?
  percentile      Float?
  strengths       Json?
  improvements    Json?
  recommendations Json?
  completed_at    DateTime
  time_taken      Int
  attempt_number  Int                  @default(1)
  employee_id     Int
  campaign        assessment_campaigns @relation(fields: [campaign_id], references: [id])
  employee        employees            @relation(fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_assessment_results_employee")

  @@index([campaign_id])
}

model migration_log {
  id            Int       @id @default(autoincrement())
  step          String?   @db.VarChar(100)
  status        String?   @db.VarChar(20)
  affected_rows Int?
  message       String?
  created_at    DateTime? @default(now()) @db.Timestamp(6)
}

model skills_sub_roles_value {
  id          Int       @id @default(autoincrement())
  id_skill    Int
  id_sub_role Int
  Value       Float?
  Grading     Float?
  created_at  DateTime? @default(now()) @db.Timestamp(6)
  updated_at  DateTime? @default(now()) @db.Timestamp(6)
  sub_roles   sub_roles @relation(fields: [id_sub_role], references: [id], onDelete: Cascade, map: "fk_skill_sub_role")
  skills      skills    @relation(fields: [id_skill], references: [id], onDelete: Cascade, map: "fk_skill_sub_skill")

  @@unique([id_skill, id_sub_role], map: "uq_skill_subrole")
  @@index([id_skill], map: "idx_skills_sub_roles_skill")
  @@index([id_sub_role], map: "idx_skills_sub_roles_sub")
}

model project_activity_logs {
  id            String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  project_id    Int
  activity_type String?   @db.VarChar(100)
  description   String?
  user_id       String?   @db.VarChar(255)
  metadata      Json?
  created_at    DateTime? @default(now()) @db.Timestamp(6)
  projects      projects  @relation(fields: [project_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([created_at(sort: Desc)], map: "idx_project_activity_created")
  @@index([project_id], map: "idx_project_activity_project")
  @@index([activity_type], map: "idx_project_activity_type")
}

model project_matching_results {
  id                   String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  project_role_id      String        @db.Uuid
  employee_id          Int
  match_score          Decimal?      @db.Decimal(5, 2)
  skills_match         Decimal?      @db.Decimal(5, 2)
  availability_match   Decimal?      @db.Decimal(5, 2)
  experience_match     Decimal?      @db.Decimal(5, 2)
  preference_match     Decimal?      @db.Decimal(5, 2)
  ai_reasoning         Json?
  suggested_allocation Int?
  risk_factors         Json?
  growth_potential     Json?
  is_shortlisted       Boolean?      @default(false)
  reviewed_by          String?       @db.VarChar(255)
  reviewed_at          DateTime?     @db.Timestamp(6)
  created_at           DateTime?     @default(now()) @db.Timestamp(6)
  employees            employees     @relation(fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  project_roles        project_roles @relation(fields: [project_role_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([project_role_id, employee_id])
  @@index([employee_id], map: "idx_project_matching_employee")
  @@index([project_role_id], map: "idx_project_matching_role")
  @@index([match_score(sort: Desc)], map: "idx_project_matching_score")
  @@index([is_shortlisted], map: "idx_project_matching_shortlist")
}

model project_milestones {
  id                    String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  project_id            Int
  name                  String    @db.VarChar(255)
  description           String?
  due_date              DateTime? @db.Date
  completed_date        DateTime? @db.Date
  status                String?   @default("PENDING") @db.VarChar(50)
  deliverables          Json?
  dependencies          String[]  @db.VarChar(255)
  completion_percentage Int?      @default(0)
  created_at            DateTime? @default(now()) @db.Timestamp(6)
  updated_at            DateTime? @default(now()) @db.Timestamp(6)
  projects              projects  @relation(fields: [project_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([due_date], map: "idx_project_milestones_due_date")
  @@index([project_id], map: "idx_project_milestones_project")
  @@index([status], map: "idx_project_milestones_status")
}

model project_roles {
  id                         String                     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  project_id                 Int
  role_code                  String?                    @db.VarChar(100)
  title                      String                     @db.VarChar(255)
  seniority                  String?                    @db.VarChar(50)
  quantity                   Int?                       @default(1)
  required_skills            Json?
  soft_skills                Json?
  hard_skills                Json?
  certifications             String[]                   @db.VarChar(255)
  required_certifications    String[]                   @db.VarChar(255)
  preferred_certifications   String[]                   @db.VarChar(255)
  competencies               Json?
  preferences                Json?
  sub_role_id                Int?
  min_experience_years       Int?                       @default(0)
  preferred_experience_years Int?
  required_languages         Json?
  preferred_languages        Json?
  availability_required      Int?
  allocation_percentage      Int?                       @default(100)
  is_billable                Boolean?                   @default(true)
  is_urgent                  Boolean?                   @default(false)
  is_critical                Boolean?                   @default(false)
  work_mode                  String?                    @db.VarChar(50)
  location                   String?                    @db.VarChar(255)
  language_required          String?                    @db.VarChar(100)
  budget_range               Json?
  constraints                Json?
  opportunities              Json?
  priority                   String?                    @default("NORMAL") @db.VarChar(20)
  status                     String?                    @default("OPEN") @db.VarChar(50)
  created_at                 DateTime?                  @default(now()) @db.Timestamp(6)
  updated_at                 DateTime?                  @default(now()) @db.Timestamp(6)
  role_id                    Int?
  project_matching_results   project_matching_results[]
  projects                   projects                   @relation(fields: [project_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  sub_role                   sub_roles?                 @relation(fields: [sub_role_id], references: [id], onUpdate: NoAction)

  @@index([competencies], map: "idx_project_roles_competencies", type: Gin)
  @@index([hard_skills], map: "idx_project_roles_hard_skills", type: Gin)
  @@index([is_critical], map: "idx_project_roles_is_critical")
  @@index([is_urgent], map: "idx_project_roles_is_urgent")
  @@index([priority], map: "idx_project_roles_priority")
  @@index([project_id], map: "idx_project_roles_project_id")
  @@index([seniority], map: "idx_project_roles_seniority")
  @@index([status], map: "idx_project_roles_status")
  @@index([sub_role_id], map: "idx_project_roles_sub_role_id")
}

model Certification {
  id                        String                    @id @default(uuid())
  code                      String                    @unique
  name                      String
  category                  String                    @db.VarChar(100)
  level                     CertificationLevel?
  provider                  String?
  description               String?
  url                       String?
  validity_years            Int?                      @map("validity_years")
  is_active                 Boolean                   @default(true)
  created_at                DateTime                  @default(now())
  updated_at                DateTime                  @updatedAt
  created_by                Int?
  normalized_name           String?                   @unique(map: "idx_certifications_normalized_name") @db.VarChar(255)
  issuing_organization      String?                   @db.VarChar(255)
  standard_duration_months  Int?
  is_renewable              Boolean?                  @default(true)
  verification_url_template String?
  employee_certifications   employee_certifications[]
  tenant_certifications     TenantCertification[]

  @@index([category])
  @@index([is_active])
  @@index([name])
  @@index([category], map: "idx_certifications_category")
  @@index([issuing_organization], map: "idx_certifications_issuing_org")
  @@map("certifications")
}

model TenantCertification {
  id               String        @id @default(uuid())
  tenant_id        String
  certification_id String
  custom_name      String?
  is_required      Boolean       @default(false)
  priority         Int           @default(0)
  notes            String?
  created_at       DateTime      @default(now())
  certification    Certification @relation(fields: [certification_id], references: [id])
  tenant           tenants       @relation(fields: [tenant_id], references: [id])

  @@unique([tenant_id, certification_id])
  @@map("tenant_certifications")
}

model companies {
  id                        Int                         @id @default(autoincrement())
  name                      String                      @db.VarChar(200)
  normalized_name           String?                     @unique @db.VarChar(200)
  industry_id               Int?
  website                   String?
  created_at                DateTime?                   @default(now()) @db.Timestamp(6)
  updated_at                DateTime?                   @default(now()) @db.Timestamp(6)
  industries                industries?                 @relation(fields: [industry_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  employee_work_experiences employee_work_experiences[]

  @@index([industry_id], map: "idx_companies_industry")
  @@index([normalized_name], map: "idx_companies_normalized_name")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model cv_extractions {
  id                        String                      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                 String                      @db.Uuid
  employee_id               Int
  original_filename         String?                     @db.VarChar(500)
  original_file_path        String?
  file_size_bytes           BigInt?
  file_type                 String?                     @db.VarChar(50)
  extraction_result         Json?
  status                    String?                     @default("pending") @db.VarChar(50)
  error_message             String?
  processing_time_seconds   Float?
  llm_model_used            String?                     @db.VarChar(100)
  llm_tokens_used           Int?
  deleted_at                DateTime?                   @db.Timestamp(6)
  deleted_by                String?
  created_at                DateTime?                   @default(now()) @db.Timestamp(6)
  updated_at                DateTime?                   @default(now()) @db.Timestamp(6)
  updated_by                String?
  file_content              Bytes?
  extracted_text            String?
  llm_cost                  Decimal?                    @db.Decimal(10, 6)
  employees                 employees                   @relation(fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  employee_additional_info  employee_additional_info[]
  employee_awards           employee_awards[]
  employee_certifications   employee_certifications[]
  employee_domain_knowledge employee_domain_knowledge[]
  employee_education        employee_education[]
  employee_languages        employee_languages[]
  employee_projects         employee_projects[]
  employee_publications     employee_publications[]
  employee_skills           employee_skills[]
  employee_work_experiences employee_work_experiences[]

  @@index([extraction_result], map: "idx_cv_extractions_result_gin", type: Gin)
}

model education_degrees {
  id                     Int                  @id @default(autoincrement())
  degree_type            String               @unique @db.VarChar(100)
  degree_level           Int
  italian_equivalent     String?              @db.VarChar(100)
  description            String?
  typical_duration_years Int?
  created_at             DateTime?            @default(now()) @db.Timestamp(6)
  updated_at             DateTime?            @default(now()) @db.Timestamp(6)
  employee_education     employee_education[]
}

model employee_additional_info {
  id                   String          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  employee_id          Int             @unique
  date_of_birth        DateTime?       @db.Date
  place_of_birth       String?         @db.VarChar(200)
  nationality          String?         @db.VarChar(100)
  marital_status       String?         @db.VarChar(50)
  personal_email       String?         @db.VarChar(200)
  personal_phone       String?         @db.VarChar(50)
  linkedin_url         String?
  github_url           String?
  portfolio_url        String?
  hobbies_interests    String[]
  volunteer_experience String?
  cv_extraction_id     String?         @db.Uuid
  created_at           DateTime?       @default(now()) @db.Timestamp(6)
  updated_at           DateTime?       @default(now()) @db.Timestamp(6)
  tenant_id            String
  cv_extractions       cv_extractions? @relation(fields: [cv_extraction_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  employees            employees       @relation(fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenants              tenants         @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_employee_additional_info_tenant")

  @@index([employee_id], map: "idx_employee_additional_info_employee")
  @@index([tenant_id, employee_id], map: "idx_employee_additional_info_tenant_employee")
}

model employee_awards {
  id                   String          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  employee_id          Int
  award_name           String          @db.VarChar(300)
  issuing_organization String          @db.VarChar(200)
  date_received        DateTime?       @db.Date
  description          String?
  cv_extraction_id     String?         @db.Uuid
  created_at           DateTime?       @default(now()) @db.Timestamp(6)
  tenant_id            String
  cv_extractions       cv_extractions? @relation(fields: [cv_extraction_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  employees            employees       @relation(fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenants              tenants         @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_employee_awards_tenant")

  @@index([employee_id], map: "idx_employee_awards_employee")
  @@index([tenant_id, employee_id], map: "idx_employee_awards_tenant_employee")
}

model employee_certifications {
  id                   String          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  employee_id          Int
  certification_id     String?
  certification_name   String          @db.VarChar(300)
  issuing_organization String?         @db.VarChar(200)
  issue_date           DateTime?       @db.Date
  expiry_date          DateTime?       @db.Date
  is_active            Boolean?        @default(true)
  credential_id        String?         @db.VarChar(200)
  credential_url       String?
  cv_extraction_id     String?         @db.Uuid
  created_at           DateTime?       @default(now()) @db.Timestamp(6)
  updated_at           DateTime?       @default(now()) @db.Timestamp(6)
  tenant_id            String
  certifications       Certification?  @relation(fields: [certification_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  cv_extractions       cv_extractions? @relation(fields: [cv_extraction_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  employees            employees       @relation(fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenants              tenants         @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_employee_certifications_tenant")

  @@index([employee_id], map: "idx_employee_certifications_employee")
  @@index([tenant_id, employee_id], map: "idx_employee_certifications_tenant_employee")
}

model employee_domain_knowledge {
  id               Int             @id @default(autoincrement())
  employee_id      Int
  domain_type      String          @db.VarChar(50)
  domain_value     String          @db.VarChar(255)
  source           String?         @default("cv_extracted") @db.VarChar(50)
  cv_extraction_id String?         @db.Uuid
  confidence_score Decimal?        @db.Decimal(3, 2)
  years_experience Int?
  created_at       DateTime?       @default(now()) @db.Timestamp(6)
  updated_at       DateTime?       @default(now()) @db.Timestamp(6)
  tenant_id        String
  employees        employees       @relation(fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_employee_domain_knowledge_employee")
  cv_extractions   cv_extractions? @relation(fields: [cv_extraction_id], references: [id], onUpdate: NoAction, map: "fk_employee_domain_knowledge_extraction")
  tenants          tenants         @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_employee_domain_knowledge_tenant")

  @@unique([employee_id, domain_type, domain_value], map: "unique_employee_domain")
  @@index([employee_id], map: "idx_employee_domain_knowledge_employee")
  @@index([domain_type], map: "idx_employee_domain_knowledge_type")
  @@index([domain_value], map: "idx_employee_domain_knowledge_value")
  @@index([domain_type, domain_value], map: "idx_employee_domain_knowledge_type_value")
  @@index([tenant_id, employee_id], map: "idx_employee_domain_knowledge_tenant_employee")
  @@map("employee_domain_knowledge")
}

model employee_education {
  id                   String             @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  employee_id          Int
  degree_id            Int?
  degree_name          String             @db.VarChar(200)
  field_of_study       String?            @db.VarChar(200)
  institution_name     String             @db.VarChar(200)
  institution_location String?            @db.VarChar(200)
  start_date           DateTime?          @db.Date
  end_date             DateTime?          @db.Date
  is_current           Boolean?           @default(false)
  grade                String?            @db.VarChar(50)
  honors               String?
  thesis_title         String?
  cv_extraction_id     String?            @db.Uuid
  created_at           DateTime?          @default(now()) @db.Timestamp(6)
  updated_at           DateTime?          @default(now()) @db.Timestamp(6)
  tenant_id            String
  cv_extractions       cv_extractions?    @relation(fields: [cv_extraction_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  education_degrees    education_degrees? @relation(fields: [degree_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  employees            employees          @relation(fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenants              tenants            @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_employee_education_tenant")

  @@index([employee_id], map: "idx_employee_education_employee")
  @@index([tenant_id, employee_id], map: "idx_employee_education_tenant_employee")
}

model employee_languages {
  id                          String                       @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  employee_id                 Int
  language_id                 Int
  proficiency_level_id        Int?
  listening_level             String?                      @db.VarChar(10)
  reading_level               String?                      @db.VarChar(10)
  spoken_interaction_level    String?                      @db.VarChar(10)
  spoken_production_level     String?                      @db.VarChar(10)
  writing_level               String?                      @db.VarChar(10)
  is_native                   Boolean?                     @default(false)
  cv_extraction_id            String?                      @db.Uuid
  created_at                  DateTime?                    @default(now()) @db.Timestamp(6)
  updated_at                  DateTime?                    @default(now()) @db.Timestamp(6)
  tenant_id                   String
  cv_extractions              cv_extractions?              @relation(fields: [cv_extraction_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  employees                   employees                    @relation(fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  languages                   languages                    @relation(fields: [language_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  language_proficiency_levels language_proficiency_levels? @relation(fields: [proficiency_level_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tenants                     tenants                      @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_employee_languages_tenant")

  @@unique([employee_id, language_id])
  @@index([employee_id], map: "idx_employee_languages_employee")
  @@index([language_id], map: "idx_employee_languages_language")
  @@index([tenant_id, employee_id], map: "idx_employee_languages_tenant_employee")
}

model employee_projects {
  id                String          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  employee_id       Int
  project_name      String          @db.VarChar(200)
  description       String
  start_date        DateTime?       @db.Date
  end_date          DateTime?       @db.Date
  is_current        Boolean?        @default(false)
  role              String?         @db.VarChar(100)
  technologies_used String[]
  project_url       String?
  cv_extraction_id  String?         @db.Uuid
  created_at        DateTime?       @default(now()) @db.Timestamp(6)
  updated_at        DateTime?       @default(now()) @db.Timestamp(6)
  tenant_id         String
  cv_extractions    cv_extractions? @relation(fields: [cv_extraction_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  employees         employees       @relation(fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenants           tenants         @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_employee_projects_tenant")

  @@index([employee_id], map: "idx_employee_projects_employee")
  @@index([tenant_id, employee_id], map: "idx_employee_projects_tenant_employee")
}

model employee_publications {
  id               String          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  employee_id      Int
  title            String
  authors          Json
  publication_type String?         @db.VarChar(100)
  venue            String?         @db.VarChar(300)
  publication_date DateTime?       @db.Date
  doi              String?         @db.VarChar(200)
  isbn             String?         @db.VarChar(50)
  url              String?
  abstract         String?
  keywords         String[]
  cv_extraction_id String?         @db.Uuid
  created_at       DateTime?       @default(now()) @db.Timestamp(6)
  tenant_id        String
  cv_extractions   cv_extractions? @relation(fields: [cv_extraction_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  employees        employees       @relation(fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenants          tenants         @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_employee_publications_tenant")

  @@index([employee_id], map: "idx_employee_publications_employee")
  @@index([tenant_id, employee_id], map: "idx_employee_publications_tenant_employee")
}

model employee_work_experiences {
  id               String          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  employee_id      Int
  company_id       Int?
  company_name     String          @db.VarChar(200)
  company_location String?         @db.VarChar(200)
  company_industry String?         @db.VarChar(100)
  job_title        String          @db.VarChar(200)
  employment_type  String?         @db.VarChar(50)
  seniority_level  String?         @db.VarChar(50)
  start_date       DateTime?       @db.Date
  end_date         DateTime?       @db.Date
  is_current       Boolean?        @default(false)
  description      String?
  responsibilities String[]
  achievements     String[]
  projects         Json?
  skills_used      String[]
  cv_extraction_id String?         @db.Uuid
  created_at       DateTime?       @default(now()) @db.Timestamp(6)
  updated_at       DateTime?       @default(now()) @db.Timestamp(6)
  tenant_id        String
  companies        companies?      @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  cv_extractions   cv_extractions? @relation(fields: [cv_extraction_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  employees        employees       @relation(fields: [employee_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenants          tenants         @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_employee_work_experiences_tenant")

  @@index([employee_id], map: "idx_employee_work_experiences_employee")
  @@index([tenant_id, employee_id], map: "idx_employee_work_experiences_tenant_employee")
}

model industries {
  id         Int         @id @default(autoincrement())
  name       String      @unique @db.VarChar(100)
  sector     String?     @db.VarChar(100)
  created_at DateTime?   @default(now()) @db.Timestamp(6)
  updated_at DateTime?   @default(now()) @db.Timestamp(6)
  companies  companies[]
}

model language_proficiency_levels {
  id                 Int                  @id @default(autoincrement())
  level              String               @unique @db.VarChar(50)
  cefr_code          String               @unique @db.VarChar(10)
  description        String?
  numeric_value      Int                  @unique
  created_at         DateTime?            @default(now()) @db.Timestamp(6)
  updated_at         DateTime?            @default(now()) @db.Timestamp(6)
  employee_languages employee_languages[]
}

model languages {
  id                 Int                  @id @default(autoincrement())
  name               String               @unique @db.VarChar(100)
  iso_code_639_1     String?              @db.VarChar(2)
  iso_code_639_3     String?              @db.VarChar(3)
  created_at         DateTime?            @default(now()) @db.Timestamp(6)
  updated_at         DateTime?            @default(now()) @db.Timestamp(6)
  employee_languages employee_languages[]
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model role_soft_skills_deleted_021 {
  id          Int?
  roleId      Int?
  softSkillId Int?
  priority    Int?
  minScore    Float?
  createdAt   DateTime?
  isRequired  Boolean?
  weight      Float?
  description String?
  targetScore Float?
  updatedAt   DateTime?

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model roles_deleted_021 {
  id             Int?
  Role           String?
  NameKnown_Role String?
  Synonyms_Role  String[]
  createdAt      DateTime?
  department     String?
  description    String?
  isActive       Boolean?
  level          String?
  name           String?
  updatedAt      DateTime?

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model sub_roles_backup_022 {
  id                 Int?
  Sub_Role           String?
  NameKnown_Sub_Role String?
  Synonyms_Sub_Role  String[]

  @@ignore
}

enum ScheduleStatus {
  SCHEDULED
  NOTIFIED
  IN_PROGRESS
  COMPLETED
  EXPIRED
  CANCELLED
}

enum Trend {
  IMPROVING
  STABLE
  DECLINING
}

enum CertificationCategory {
  CLOUD
  PROJECT
  SECURITY
  DEVELOPMENT
  DATABASE
  BUSINESS
  CUSTOM
}

enum CertificationLevel {
  FOUNDATION
  ASSOCIATE
  PROFESSIONAL
  EXPERT
}
